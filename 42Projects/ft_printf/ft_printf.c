/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_printf.c                                        :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: hdeniz <marvin@42.fr>                      +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2022/12/23 11:21:55 by hdeniz            #+#    #+#             */
/*   Updated: 2022/12/23 14:42:28 by hdeniz           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include	"ft_printf.h"

static inline void
	pf_do_command(va_list v_args, const char *(__), int x, int *flags)
{
	if ((__)[x] == 's')
		pf__s(va_arg(v_args, char *), flags);
	else if ((__)[x] == 'c')
		pf__c(va_arg(v_args, int), flags);
	else if ((__)[x] == 'd' || (__)[x] == 'i')
		pf__d(va_arg(v_args, int), flags);
	else if ((__)[x] == 'p')
		pf__p((long long)va_arg(v_args, void *), flags);
	else if ((__)[x] == 'u')
		pf__u(va_arg(v_args, unsigned int), flags);
	else if ((__)[x] == 'x' || (__)[x] == 'X')
		pf__x(va_arg(v_args, unsigned int), (__)[x], flags);
	else if ((__)[x] == 'o')
		pf__o(va_arg(v_args, unsigned int), flags);
	else if ((__)[x] == 'b')
		pf__b(va_arg(v_args, unsigned int), flags);
	else if ((__)[x] == '%')
		pf__perc(flags);
	else if ((__)[x] == 'f')
		pf__f(va_arg(v_args, double), flags);
	else if ((__)[x] == 'n')
		pf__n(va_arg(v_args, int *), flags);
}

static inline int
	pf_perc(const char *(__), int x, va_list v_args, int *flags)
{
	register int	test;

	test = pf_is_flag_valid((__), (x + 1), 1, flags);
	pf_flag_collector((__), &x, flags, v_args);
	if (test != 0 && test != -1)
	{
		x++;
		pf_do_command(v_args, (__), (x - 1), flags);
	}
	if (test == -1)
		x -= 1;
	pf_set_flags(flags);
	return (x);
}

int
	ft_printf(const char *(__), ...)
{
	int				flags[256];
	va_list			v_args;
	register int	x;

	x = pf_set_flags(flags);
	flags[1] = 0;
	va_start(v_args, (__));
	while ((__)[x] != '\0')
	{
		if ((__)[x] == '%')
		{
			x = pf_perc((__), x, v_args, flags);
			if (x == -1 || (__)[x] == '\0' || (__)[x - 1] == '\0')
				break ;
			continue ;
		}
		else
		{
			flags[1] += 1;
			write(1, &(__)[x], 1);
		}
		x++;
	}
	va_end(v_args);
	return (flags[1]);
}

int
	ft_printf_fd(int fd, const char *(__), ...)
{
	int				flags[256];
	va_list			v_args;
	register int	x;

	x = pf_set_flags_fd(flags, fd);
	flags[1] = 0;
	va_start(v_args, (__));
	while ((__)[x] != '\0')
	{
		if ((__)[x] == '%')
		{
			x = pf_perc((__), x, v_args, flags);
			if (x == -1 || (__)[x] == '\0' || (__)[x - 1] == '\0')
				break ;
			continue ;
		}
		else
		{
			flags[1] += 1;
			write(flags[0], &(__)[x], 1);
		}
		x++;
	}
	va_end(v_args);
	return (flags[1]);
}

/*---------------------------------*
| c -> character => "t"            |
| s ->    string => "testing"      |
| p ->   pointer => "0x0fff240102" |
| u ->  unsigned => "44029493"     |
| i ->   integer => "42"           |
| d ->   decimal => "-42"          |
| o ->     octal => "52"           |
| b ->    binary => "101010"       |
| x ->       hex => "fc13"         |
| X ->       HEX => "FC13"         |
| f ->     float =>"1.420000"      |
| % -> "%%" --> "%"                |
*---------------------------------*/

/*--------------------------------------------*
|      [INPUTS]    [OUTPUTS]                  |
*---------------------------------------------*
|       '_% d_' -> "_ 42_"                    |
|       '_%#x_' -> "_0x2a_"                   |
|      '_% #x_' -> "_0x2a_"                   |
|       '_%#o_' -> "_052_"                    |
|       '_%#b_' -> "_0b101010_"               |
|       '_%5d_' -> "_   42_"                  |
|      '_%05d_' -> "_00042_"                  |
|      '_%5#d_' -> "_   42_"                  |
|      '_%+5d_' -> "_  +42_"                  |
|     '_%+05d_' -> "_+0042_"                  |
|    '_% + 5d_' -> "_  +42_"                  |
|    '_% - 5d_' -> "_ 42  _"                  |
|    '_% -+5d_' -> "_+42  _"                  |
|    '_% .+5d_' -> "_  +42_"                  |
|   '_% .3+5d_' -> "_ +042_"                  |
|    '_%.7 5d_' -> "_ 0000042_"               |
|    '_%.7+5d_' -> "_+0000042_"               |
|     '_%5.7d_' -> "_0000042_"                |
|  '_%62 5.7d_' -> "_ 0000042_"               |
| '_%.20 -24p_' -> "0x000000007ffee9d1aa1c  " |
|  '_%.20 24p_' -> "  0x000000007ffee726aa1c" |
*--------------------------------------------*/

/*--------------------------------------*
|        %d ==> "42"               [ 2] |
|     %.10i ==> "0000000042"       [10] |
|      %13i ==> "           42"    [13] |
|   %13.10d ==> "   0000000042"    [13] |
|   %10.13d ==> "0000000000042"    [13] |
|  %+10.13i ==> "+0000000000042"   [14] |
|  % 10.13d ==> " 0000000000042"   [14] |
|  %-13.10d ==> "0000000042   "    [13] |
| % -13.10i ==> " 0000000042  "    [13] |
| %+-13.10d ==> "+0000000042  "    [13] |
|     %010d ==> "0000000042"       [10] |
|    %010.d ==> "        42"       [10] |
|   %010.5d ==> "     00042"       [10] |
*--------------------------------------*/

/*------------------------------------*
| %15.12p ==> " 0x00000000002a"  [15] |
|%-15.12p ==> "0x00000000002a "  [15] |
*------------------------------------*/

/*-----------------------------------------------------------------------*
| %+-15.13x ==> "000000000002a  "  [15]  "0000000101010  " <== %+-15.13b |
|   %13.10X ==> "   000000002A"    [13]    "   0000101010" <== %13.10b   |
|  %#15.12X ==> " 0X00000000002A"  [15]  " 0b000000101010" <== %#15.12b  |
| %-#15.12X ==> "0X00000000002A "  [15]  "0b000000101010 " <== %-#15.12b |
*-----------------------------------------------------------------------*/

/*--------------------------------------*
| %-#15.12o ==> "000000000052   "  [15] |
|     %-15o ==> "52             "  [15] |
|    %-#15o ==> "052            "  [15] |
|   %-#15.o ==> "052            "  [15] |
|  %-#15.4o ==> "0052           "  [15] |
|   %#15.4o ==> "           0052"  [15] |
|    %#15.o ==> "            052"  [15] |
*--------------------------------------*/
